---
title: "HW 02 - Water and Sanitation - Answer Key"
author: "Tasneem Arabi"
date: "09/24/25"
output: github_document
---

## Load packages and data

```{r load-packages-data, message = FALSE}
library(tidyverse)
wat_san <- read_csv("data/water-and-sanitation.csv")
```

## Exercises

### Exercise 1

```{r}
nrow(wat_san)
```

### Exercise 2

Each row represents a country–year record (an Entity in a given Year) with the percentages of the population in that country/year at different water and sanitation service levels.

### Exercise 3

Between 2000 and 2020, the distribution of no sanitation service shifts left (toward lower percentages) and becomes more concentrated at lower values—evidence that open defecation generally declined over time, though some high-value outliers remain.

```{r no-sanitation-years}
wat_san %>% 
  filter(Entity != "World", Year %in% c(2000, 2020)) %>% 
  ggplot(aes(x = sanitation_none)) +
  geom_histogram(binwidth = 5, boundary = 0, closed = "left") +
  facet_wrap(~ Year) +
  labs(x = "No sanitation (% of population)", y = "Count of countries",
       title = "Distribution of 'no sanitation' across countries in 2000 vs 2020")
```

### Exercise 4

Countries with the highest “no sanitation” in 2000 (descending). Comparing water_none and sanitation_none, lack of sanitation tends to be higher than lack of water, but there’s a clear positive relationship (countries doing poorly on sanitation also tend to do poorly on water).

```{r bottom-5-2000}
wat_san %>% 
  filter(Year == 2000, Entity != "World") %>% 
  arrange(desc(sanitation_none)) %>% 
  select(Entity, sanitation_none, water_none) %>% 
  slice_head(n = 10)
```

### Exercise 5

The scatter shows a strong positive association between water_none and sanitation_none in 2000 (countries with higher lack of water also tend to have higher lack of sanitation).

```{r all-2000-plot}
wat_san %>% 
  filter(Year == 2000, Entity != "World") %>% 
  ggplot(aes(x = water_none, y = sanitation_none)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(x = "No water service (% of population)", 
       y = "No sanitation (% of population)",
       title = "2000: No water vs No sanitation")
```

### Exercise 6

Top “no sanitation” countries in 2020. Many countries improve and the very top list changes—some countries drop out, others enter—indicating progress and/or different rates of change.

```{r bottom-5-2020}
wat_san %>% 
  filter(Year == 2020, Entity != "World") %>% 
  arrange(desc(sanitation_none)) %>% 
  select(Entity, sanitation_none, water_none) %>% 
  slice_head(n = 10)
```

### Exercise 7

Summary statistics for the top 5 “no sanitation” countries in 2000 and 2020. The 2020 group shows lower central tendency and spread versus 2000 (progress). Sanitation levels are consistently worse than water levels, though both improve.

```{r progress-summary}
# top-5 per year based on sanitation_none
top5_2000 <- wat_san %>% 
  filter(Year == 2000, Entity != "World") %>% 
  slice_max(sanitation_none, n = 5, with_ties = TRUE)

top5_2020 <- wat_san %>% 
  filter(Year == 2020, Entity != "World") %>% 
  slice_max(sanitation_none, n = 5, with_ties = TRUE)

bind_rows(top5_2000, top5_2020) %>% 
  group_by(Year) %>% 
  summarize(
    water_none_min    = min(water_none, na.rm = TRUE),
    water_none_mean   = mean(water_none, na.rm = TRUE),
    water_none_median = median(water_none, na.rm = TRUE),
    water_none_stdev  = sd(water_none, na.rm = TRUE),
    water_none_iqr    = IQR(water_none, na.rm = TRUE),
    water_none_max    = max(water_none, na.rm = TRUE),
    
    sanitation_none_min    = min(sanitation_none, na.rm = TRUE),
    sanitation_none_mean   = mean(sanitation_none, na.rm = TRUE),
    sanitation_none_median = median(sanitation_none, na.rm = TRUE),
    sanitation_none_stdev  = sd(sanitation_none, na.rm = TRUE),
    sanitation_none_iqr    = IQR(sanitation_none, na.rm = TRUE),
    sanitation_none_max    = max(sanitation_none, na.rm = TRUE)
  )  
```

### Exercise 8

Time series for World and the union of top-5 countries from 2000 and 2020. Most show declining “no sanitation” rates over time; “World” declines steadily, and several countries show faster-than-global improvement.

```{r country-global-changes}
# compute set of countries to plot
countries <- bind_rows(top5_2000, top5_2020) %>% 
  pull(Entity) %>% 
  unique()

wat_san %>% 
  filter(Entity %in% c("World", countries)) %>% 
  ggplot(aes(x = Year, y = sanitation_none, color = Entity)) +
  geom_line() +
  geom_point(size = 0.8) +
  labs(y = "No sanitation (% of population)",
       title = "Trends in 'no sanitation' for top-5 (2000 & 2020) vs World")
```
